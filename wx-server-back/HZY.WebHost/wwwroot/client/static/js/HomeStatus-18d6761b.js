import{b as k,s as p,r as L,a as Q,o as b,t as _,c as d,j as i,q as g,w as c,f as x,l as t,n as I,k as l,e as a,v as f,d as h}from"./index-e5dbf13d.js";const w=k();var v={async getWxUserInfo(r){const e=await w.getUserInfo();return p(`/admin/home/user-info/${e.id}`,{bRefresh:r},!1)},async getLoginQrCode(){const r=await w.getUserInfo();return p(`/admin/home/login-qrcode/${r.id}`,null,!1)}};const j=I(" \u5C0F\u52A9\u624B\u72B6\u6001 "),N={class:"content"},O={key:2,class:"content-info"},W={class:"name"},B={class:"name"},T={class:"name"},V={key:3,class:"content-info"},q=a("div",{class:"name"},"\u8BF7\u626B\u7801\u767B\u5F55",-1),H={name:"HomeStatus"},z=Object.assign(H,{setup(r){const e=L({wxUserInfo:{avatarUrl:"https://i.52112.com/icon/jpg/256/20210901/130307/5566843.jpg",wxId:"",wxCode:"\u672A\u767B\u5F55",wxName:"\u672A\u767B\u5F55"},loginQrCode:"https://i.52112.com/icon/jpg/256/20210901/130307/5566843.jpg",online:!1,remindLoginOk:!1}),u=Q(!1);b(()=>{s.startUpdateUserStatus()});const s={getLoginQrCode:async()=>{u.value=!0;let n=await v.getLoginQrCode();n&&n.code==1&&n.data&&(_.message("\u767B\u5F55\u4E8C\u7EF4\u7801\u83B7\u53D6\u6210\u529F,\u8BF7\u626B\u7801\u767B\u5F55!","\u6210\u529F"),e.loginQrCode=n.data,e.remindLoginOk=!1),u.value=!1},startUpdateUserStatus:()=>{s.getWxUserInfo(!0),window.updateUserStatusTimed=setInterval(()=>{s.getWxUserInfo(!0)},3e3)},getWxUserInfo(n){v.getWxUserInfo(n).then(o=>{console.log(o),o&&o.code==1&&o.data&&(e.wxUserInfo=o.data,e.online=e.wxUserInfo.wxId!=null&&e.wxUserInfo.wxId!="",e.online&&!e.remindLoginOk&&(_.message("\u767B\u9646\u6210\u529F!","\u6210\u529F"),e.remindLoginOk=!0,clearInterval(window.updateUserStatusTimed)))}).catch(o=>{console.log(o),clearInterval(window.updateUserStatusTimed)})}};return(n,o)=>{const U=d("a-tag"),m=d("a-image"),y=d("a-card"),C=d("a-spin");return i(),g(C,{tip:"\u6B63\u5728\u83B7\u53D6\u767B\u5F55\u4E8C\u7EF4\u7801",spinning:u.value},{default:c(()=>[x(y,{class:"home-status",bordered:!1,hoverable:"",headStyle:n.headStyle},{title:c(()=>[j,x(U,{color:t(e).online?"#87d068":"#6a615d"},{default:c(()=>[I(l(t(e).online?"\u5728\u7EBF":"\u79BB\u7EBF"),1)]),_:1},8,["color"])]),default:c(()=>[a("div",N,[t(e).online?(i(),g(m,{key:0,width:150,class:"avatar",preview:!1,src:t(e).wxUserInfo.avatarUrl},null,8,["src"])):f("",!0),t(e).online?f("",!0):(i(),g(m,{key:1,width:150,preview:!1,src:t(e).loginQrCode},null,8,["src"])),t(e).online?(i(),h("div",O,[a("div",W,"\u5FAE\u4FE1id: "+l(t(e).wxUserInfo.wxId),1),a("div",B,"\u5FAE\u4FE1code: "+l(t(e).wxUserInfo.wxCode),1),a("div",T,"\u6635\u79F0: "+l(t(e).wxUserInfo.wxName),1)])):f("",!0),t(e).online?f("",!0):(i(),h("div",V,[q,a("a",{onClick:o[0]||(o[0]=(...S)=>s.getLoginQrCode&&s.getLoginQrCode(...S))},"\u70B9\u51FB\u83B7\u53D6\u767B\u5F55\u4E8C\u7EF4\u7801")]))])]),_:1},8,["headStyle"])]),_:1},8,["spinning"])}}});export{z as default};
