import{b as B,r as F,a as g,i as D,o as N,c as d,j as m,d as _,f as t,w as a,l as r,q as R,A as k,v as V,F as T,C as z,n as u,k as C,e as A,t as x}from"./index-4ae57506.js";import M from"./List-24af0aac.js";import{w as h}from"./wxContactService-7c4cc936.js";const j=u("\u67E5\u8BE2"),K=u("\u91CD\u7F6E"),P=u("\u66F4\u65B0\u8054\u7CFB\u4EBA"),$=u("\u91CD\u7F6E"),q=u(" \u68C0\u7D22 "),E=["src"],G={name:"wxContactIndex"},X=Object.assign(G,{setup(H){const b=B(),o=F({search:{state:!0,vm:{name:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,columns:[],data:[]}),v=g(null),p=g(null),y=b.getPowerByMenuId(D.currentRoute.value.meta.menuId),l={onChange(n){const{currentPage:e,pageSize:i}=n;o.page=e==0?1:e,o.rows=i,l.findList()},onResetSearch(){o.page=1;let n=o.search.vm;for(let e in n)n[e]=null;l.findList()},findList(){o.loading=!0,h.findList(o.rows,o.page,o.search.vm).then(n=>{let e=n.data;o.loading=!1,o.page=e.page,o.rows=e.size,o.total=e.total,o.columns=e.columns,o.data=e.dataSource})},deleteList(n){let e=[];n?e.push(n):e=p.value.table.getCheckboxRecords().map(i=>i.id),h.deleteList(e).then(i=>{i.code==1&&(x.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),l.findList())})},openForm(n){v.value.openForm({visible:!0,key:n})},updateContact(){h.updateContact().then(n=>{n.code==1&&(x.message("\u66F4\u65B0\u8054\u7CFB\u4EBA\u6210\u529F!","\u6210\u529F"),l.findList())})}};return N(()=>{l.findList()}),(n,e)=>{const i=d("a-input"),w=d("a-col"),f=d("a-button"),L=d("a-row"),S=d("a-checkbox"),I=d("a-popover"),c=d("vxe-column"),O=d("Info");return m(),_("div",null,[t(M,{ref_key:"refList",ref:p,tableData:r(o),onOnChange:l.onChange},{search:a(()=>[t(L,{gutter:[15,15]},{default:a(()=>[t(w,{xs:24,sm:12,md:8,lg:6,xl:4},{default:a(()=>[t(i,{value:r(o).search.vm.name,"onUpdate:value":e[0]||(e[0]=s=>r(o).search.vm.name=s),placeholder:"\u6635\u79F0\u6216\u8005\u5907\u6CE8"},null,8,["value"])]),_:1}),t(w,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:a(()=>[t(f,{type:"primary",class:"mr-15",onClick:l.findList},{default:a(()=>[j]),_:1},8,["onClick"]),t(f,{class:"mr-15",onClick:l.onResetSearch},{default:a(()=>[K]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-right":a(()=>[t(f,{onClick:l.updateContact,type:"primary"},{default:a(()=>[P]),_:1},8,["onClick"]),t(i,{value:r(o).search.vm.name,"onUpdate:value":e[1]||(e[1]=s=>r(o).search.vm.name=s),placeholder:"\u540D\u79F0",onKeyup:l.findList},null,8,["value","onKeyup"]),t(f,{onClick:l.onResetSearch},{default:a(()=>[$]),_:1},8,["onClick"]),r(y).search?(m(),R(f,{key:0,onClick:e[2]||(e[2]=s=>r(o).search.state=!r(o).search.state)},{icon:a(()=>[t(k,{name:r(o).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:a(()=>[q]),_:1})):V("",!0),t(I,null,{content:a(()=>[(m(!0),_(T,null,z(r(o).columns.filter(s=>s.fieldName.substr(0,1)!="_"),s=>(m(),_("div",{key:s.id},[t(S,{checked:s.show,"onUpdate:checked":U=>s.show=U,onChange:e[3]||(e[3]=()=>n.nextTick(()=>p.value.table.refreshColumn()))},{default:a(()=>[u(C(s.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),128))]),default:a(()=>[t(f,null,{default:a(()=>[t(k,{name:"BarsOutlined"})]),_:1})]),_:1})]),"table-col-default":a(()=>[t(c,{field:"wxId",title:"\u5FAE\u4FE1ID","show-overflow":""}),t(c,{field:"wxCode",title:"\u5FAE\u4FE1Code","show-overflow":""}),t(c,{field:"name",title:"\u5FAE\u4FE1\u6635\u79F0","show-overflow":""}),t(c,{field:"alias",title:"\u5907\u6CE8","show-overflow":""}),t(c,{field:"gender",title:"\u6027\u522B","show-overflow":""},{default:a(({row:s})=>[u(C(s.gender==1?"\u7537":"\u5973"),1)]),_:1}),t(c,{field:"avatarUrl",title:"\u5934\u50CF","show-overflow":""},{default:a(({row:s})=>[A("img",{src:s.avatarUrl,width:"35",height:"35"},null,8,E)]),_:1}),t(c,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4","show-overflow":""}),t(c,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4","show-overflow":""})]),_:1},8,["tableData","onOnChange"]),t(O,{ref_key:"refForm",ref:v,onOnSuccess:e[4]||(e[4]=()=>l.findList())},null,512)])}}});export{X as default};
