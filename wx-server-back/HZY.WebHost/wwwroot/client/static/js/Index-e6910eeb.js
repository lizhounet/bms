import{b as N,r as U,a as C,i as V,o as z,c as u,j as r,d as m,f as t,w as n,l,q as g,A as x,v as f,F as j,C as A,n as k,e as P,t as T,k as q}from"./index-e5dbf13d.js";import E from"./List-d0bd0233.js";import K from"./Cdrawer-572305b4.js";import{I as M,s as h}from"./Info-b7988d34.js";import"./wxContactService-8e0e9296.js";const W=k("\u67E5\u8BE2"),G=k("\u91CD\u7F6E"),H=k(" \u65B0\u5EFA "),J=k(" \u6279\u91CF\u5220\u9664 "),Q=k("\u91CD\u7F6E"),X=k(" \u68C0\u7D22 "),Y=["onClick"],Z=["onClick"],ee=["onClick"],te=["onClick"],ae=["onClick"],ne=P("a",{class:"text-danger"},"\u5220\u9664",-1),oe={name:"wxSayEveryDayIndex"},ue=Object.assign(oe,{setup(ie){const D=N(),a=U({search:{state:!1,vm:{name:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,columns:[],data:[]}),L=C(null),w=C(null),b=C(!1),S=C(null),d=D.getPowerByMenuId(V.currentRoute.value.meta.menuId),i={onChange(s){const{currentPage:e,pageSize:p}=s;a.page=e==0?1:e,a.rows=p,i.findList()},onResetSearch(){a.page=1;let s=a.search.vm;for(let e in s)s[e]=null;i.findList()},findList(){a.loading=!0,h.findList(a.rows,a.page,a.search.vm).then(s=>{let e=s.data;a.loading=!1,a.page=e.page,a.rows=e.size,a.total=e.total,a.columns=e.columns,a.data=e.dataSource})},deleteList(s){let e=[];s?e.push(s):e=w.value.table.getCheckboxRecords().map(p=>p.id),h.deleteList(e).then(p=>{p.code==1&&(T.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),i.findList())})},openForm(s){L.value.openForm({visible:!0,key:s})},execTimedTask(s){h.execTimedTask(s).then(e=>{e.code==1&&(T.message("\u6267\u884C\u6210\u529F!","\u6210\u529F"),i.findList())})},startTimdTask(s){h.startTimdTask(s).then(e=>{e.code==1&&(T.message("\u542F\u52A8\u6210\u529F!","\u6210\u529F"),i.findList())})},stopTimdTask(s){h.stopTimdTask(s).then(e=>{e.code==1&&(T.message("\u505C\u6B62\u6210\u529F!","\u6210\u529F"),i.findList())})},showLog(s){h.queryRunLog(s).then(e=>{console.log(e),e.code==1&&(b.value=!0,S.value.state.data=e.data)})}};return z(()=>{i.findList()}),(s,e)=>{const p=u("a-input"),O=u("a-col"),_=u("a-button"),F=u("a-row"),$=u("a-popconfirm"),I=u("a-checkbox"),R=u("a-popover"),c=u("vxe-column"),y=u("a-divider");return r(),m("div",null,[t(E,{ref_key:"refList",ref:w,tableData:l(a),onOnChange:i.onChange},{search:n(()=>[t(F,{gutter:[15,15]},{default:n(()=>[t(O,{xs:24,sm:12,md:8,lg:6,xl:4},{default:n(()=>[t(p,{value:l(a).search.vm.name,"onUpdate:value":e[0]||(e[0]=o=>l(a).search.vm.name=o),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),t(O,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:n(()=>[t(_,{type:"primary",class:"mr-15",onClick:i.findList},{default:n(()=>[W]),_:1},8,["onClick"]),t(_,{class:"mr-15",onClick:i.onResetSearch},{default:n(()=>[G]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":n(()=>[l(d).insert?(r(),g(_,{key:0,type:"primary",onClick:e[1]||(e[1]=o=>i.openForm())},{icon:n(()=>[t(x,{name:"PlusOutlined"})]),default:n(()=>[H]),_:1})):f("",!0),l(d).delete?(r(),g($,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:e[2]||(e[2]=o=>i.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[t(_,{type:"danger"},{icon:n(()=>[t(x,{name:"DeleteOutlined"})]),default:n(()=>[J]),_:1})]),_:1})):f("",!0)]),"toolbar-right":n(()=>[t(p,{value:l(a).search.vm.name,"onUpdate:value":e[3]||(e[3]=o=>l(a).search.vm.name=o),placeholder:"\u540D\u79F0",onKeyup:i.findList},null,8,["value","onKeyup"]),t(_,{onClick:i.onResetSearch},{default:n(()=>[Q]),_:1},8,["onClick"]),l(d).search?(r(),g(_,{key:0,onClick:e[4]||(e[4]=o=>l(a).search.state=!l(a).search.state)},{icon:n(()=>[t(x,{name:l(a).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:n(()=>[X]),_:1})):f("",!0),t(R,null,{content:n(()=>[(r(!0),m(j,null,A(l(a).columns.filter(o=>o.fieldName.substr(0,1)!="_"),(o,v)=>(r(),m("div",{key:v},[t(I,{checked:o.show,"onUpdate:checked":B=>o.show=B,onChange:e[5]||(e[5]=()=>s.nextTick(()=>w.value.table.refreshColumn()))},{default:n(()=>[k(q(o.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),128))]),default:n(()=>[t(_,null,{default:n(()=>[t(x,{name:"BarsOutlined"})]),_:1})]),_:1})]),"table-col-default":n(()=>[t(c,{field:"receivingObjectWxId",title:"\u63A5\u6536\u5BF9\u8C61wxId",width:"150"}),t(c,{field:"receivingObjectName",title:"\u63A5\u6536\u5BF9\u8C61",width:"200"}),t(c,{field:"sendTime",title:"\u53D1\u9001\u65F6\u95F4(cron\u8868\u8FBE\u5F0F)",width:"150"}),t(c,{field:"city",title:"\u6240\u5728\u57CE\u5E02",width:"150"}),t(c,{field:"closingRemarks",title:"\u7ED3\u5C3E\u5907\u6CE8",width:"150"}),t(c,{field:"anniversaryDay",title:"\u7EAA\u5FF5\u65E5",width:"150"}),t(c,{field:"birthdayDate",title:"\u4E0B\u4E00\u6B21\u751F\u65E5\u65E5\u671F",width:"150"}),t(c,{field:"taskStateText",title:"\u8FD0\u884C\u72B6\u6001",width:"100"}),t(c,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4",width:"150"}),l(d).update||l(d).delete?(r(),g(c,{key:0,field:"id",title:"\u64CD\u4F5C",width:"300",fixed:"right"},{default:n(({row:o})=>[l(d).update?(r(),m(j,{key:0},[o.taskState==1?(r(),m("a",{key:0,href:"javascript:void(0)",onClick:v=>i.stopTimdTask(o.id)},"\u505C\u6B62",8,Y)):(r(),m("a",{key:1,href:"javascript:void(0)",onClick:v=>i.startTimdTask(o.id)},"\u542F\u52A8",8,Z))],64)):f("",!0),t(y,{type:"vertical"}),l(d).update?(r(),m("a",{key:1,href:"javascript:void(0)",onClick:v=>i.execTimedTask(o.id)},"\u7ACB\u5373\u53D1\u9001",8,ee)):f("",!0),t(y,{type:"vertical"}),l(d).update?(r(),m("a",{key:2,href:"javascript:void(0)",onClick:v=>i.showLog(o.id)},"\u67E5\u770B\u65E5\u5FD7",8,te)):f("",!0),t(y,{type:"vertical"}),l(d).update?(r(),m("a",{key:3,href:"javascript:void(0)",onClick:v=>i.openForm(o.id)},"\u7F16\u8F91",8,ae)):f("",!0),t(y,{type:"vertical"}),l(d).delete?(r(),g($,{key:4,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:v=>i.deleteList(o.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[ne]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["tableData","onOnChange"]),t(M,{ref_key:"refForm",ref:L,onOnSuccess:e[6]||(e[6]=()=>i.findList())},null,512),t(K,{visible:b.value,"onUpdate:visible":e[7]||(e[7]=o=>b.value=o),ref_key:"refCdrawer",ref:S},null,8,["visible"])])}}});export{ue as default};
